/**
 * Generated by orval v6.20.0 🍺
 * Do not edit manually.
 * Kayord.IOT
 * OpenAPI spec version: v1
 */
import { createMutation } from "@tanstack/svelte-query";
import type { CreateMutationOptions, MutationFunction } from "@tanstack/svelte-query";
import type { InternalErrorResponse, Response } from "./api.schemas";
import { useCustomClient } from "../mutator/useCustomClient";
import type { ErrorType } from "../mutator/useCustomClient";

export const useApiHook = () => {
	const api = useCustomClient<Response>();

	return () => {
		return api({ url: `/endpoint`, method: "post" });
	};
};

export const useApiMutationOptions = <
	TError = ErrorType<InternalErrorResponse>,
	TVariables = void,
	TContext = unknown,
>(options?: {
	mutation?: CreateMutationOptions<
		Awaited<ReturnType<ReturnType<typeof useApiHook>>>,
		TError,
		TVariables,
		TContext
	>;
}): CreateMutationOptions<
	Awaited<ReturnType<ReturnType<typeof useApiHook>>>,
	TError,
	TVariables,
	TContext
> => {
	const { mutation: mutationOptions } = options ?? {};

	const api = useApiHook();

	const mutationFn: MutationFunction<
		Awaited<ReturnType<ReturnType<typeof useApiHook>>>,
		TVariables
	> = () => {
		return api();
	};

	return { mutationFn, ...mutationOptions };
};

export type ApiMutationResult = NonNullable<Awaited<ReturnType<ReturnType<typeof useApiHook>>>>;

export type ApiMutationError = ErrorType<InternalErrorResponse>;

export const createApi = <
	TError = ErrorType<InternalErrorResponse>,
	TVariables = void,
	TContext = unknown,
>(options?: {
	mutation?: CreateMutationOptions<
		Awaited<ReturnType<ReturnType<typeof useApiHook>>>,
		TError,
		TVariables,
		TContext
	>;
}) => {
	const mutationOptions = useApiMutationOptions(options);

	return createMutation(mutationOptions);
};
